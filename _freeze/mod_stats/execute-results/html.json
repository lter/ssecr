{
  "hash": "ce774b63dd33301cfe6dd8a59655c7fe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis & Modeling\"\ncode-annotations: hover\n---\n\n\n## Overview\n\nGiven the wide range in statistical training in graduate curricula (and corresponding breadth of experience among early career researchers), we'll be approaching this module in a different way than the others. One half of the module will use a \"flipped approach\" where project teams will share their proposed analyses with one another. The other half of the module will be dedicated to analyses that are more common in--or exclusive to--synthesis research. Content produced by project teams during the flipped half may be linked in the [Additional Resources](https://lter.github.io/ssecr/mod_stats.html#additional-resources) section at the bottom of this module at the discretion of each team. Otherwise the content of this module will focus only on the non-flipped content.\n\n## Learning Objectives\n\nAfter completing this module you will be able to: \n\n- <u>Describe</u> proposed analytical methods to an interested audience of mixed prior experience\n- <u>Explain</u> nuance in interpretation of results of proposed analyses\n- <u>Compare</u> and contrast interpretation of results in synthesis work versus primary research\n- <u>Identify</u> statistical tests common in synthesis research\n- <u>Perform</u> some synthesis-specific analyses\n\n## Needed Packages\n\nIf you'd like to follow along with the code chunks included throughout this module, you'll need to install the following packages:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Note that these lines only need to be run once per computer\n## So you can skip this step if you've installed these before\ninstall.packages(\"tidyverse\")\ninstall.packages(\"lmerTest\")\n```\n:::\n\n\nWe'll go ahead and load some of these libraries as well to be able to better demonstrate these concepts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load needed libraries\nlibrary(tidyverse)\nlibrary(lmerTest)\n```\n:::\n\n\n## Mixed-Effects Models\n\nIn any statistical test there is at least one response variable (a.k.a. \"dependent\" variable) and some number of explanatory variables (a.k.a. \"independent\" variables). However, in biology our experiments often involve repeated sampling over time or at the same locations in order to gather enough replicates to do robust analysis. These variables are neither response nor explanatory variables but we might reasonably conclude that they affect our response and/or explanatory variables.\n\nIn essence we want to use a statistical tool that asks <u>what is the effect of the explanatory variable(s) on the response _when the variation due to these non-variable considerations are accounted for_</u>?' Such tests are called \"mixed-effects models.\" This name derives from considering explanatory variables \"fixed effects\" and these non-explanatory/response variables as \"random effects\". Including both fixed and random effects thus creates a model with \"mixed effects.\"\n\n### Random Intercepts\n\n\n\n### Random Slopes\n\n\n\n### Philosophical Note: Random vs. Fixed\n\n\n\n### Mixed-Effects Case Study\n\nLet's imagine we are researching tarantula populations for several years in the Chihuahuan Desert. Our hypothesis is that the number of tarantulas (response variable) will be greater in sites further from the nearest road (explanatory variable). We select ten study sites of varying distances from the nearest road and intensively count our furry friends for several months at three plots within each site. We return to our sites--and their associated plots--and repeat this process each year for three years. We enter our data and perform careful quality control to get it into a tidy format ready for analyis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data\ntarantula_df <- read.csv(file = file.path(\"data\", \"tarantulas.csv\"))\n\n# Check structure\nstr(tarantula_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t450 obs. of  6 variables:\n $ year           : int  2022 2022 2022 2022 2022 2022 2022 2022 2022 2022 ...\n $ road.dist_km   : num  48.3 48.3 48.3 48.3 48.3 ...\n $ site           : chr  \"site_A\" \"site_A\" \"site_A\" \"site_A\" ...\n $ plot           : chr  \"plot_a\" \"plot_a\" \"plot_a\" \"plot_a\" ...\n $ site.plot      : chr  \"A_a\" \"A_a\" \"A_a\" \"A_a\" ...\n $ tarantula_count: int  136 150 145 121 150 107 73 78 83 83 ...\n```\n\n\n:::\n:::\n\n\nOkay, the data look reasonable, but now we want to run some statistical tests and--hopefully--get some endorphine-inducingly small _p_ values. If we choose to simply ignore our possible random effects, we could fit a linear regression.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit model\ntarantula_lm <- lm(tarantula_count ~ road.dist_km, data = tarantula_df) # <1>\n\n# Extract summary\nsummary(tarantula_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tarantula_count ~ road.dist_km, data = tarantula_df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-134.608  -47.286    4.002   39.485  189.392 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    0.6664     9.0072   0.074    0.941    \nroad.dist_km   2.1936     0.1980  11.078   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 65.26 on 448 degrees of freedom\nMultiple R-squared:  0.215,\tAdjusted R-squared:  0.2133 \nF-statistic: 122.7 on 1 and 448 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n1. R syntax for statistical tests is `response ~ explanatory` a.k.a. `Y ~ X`\n\nLooks like our hypothesis is supported! There does seem to be an effect of human proximity on tarantula populations in our study sites. However, from our extensive time in the field we have developed a strong intuition that there might be substantial variation among plots within a given site. We can make a quick exploratory graph to facilitate an 'eyeball test' of whether the data show what our intuition suggest.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(tarantula_df, aes(y = tarantula_count, x = plot, fill = plot)) +\n  geom_violin(alpha = 0.5) + # <1>\n  geom_jitter(width = 0.25, size = 0.5) +\n  facet_wrap(site ~ .) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 35, hjust = 1)) # <2>\n```\n\n::: {.cell-output-display}\n![](mod_stats_files/figure-html/mem-explore-graph-1.png){fig-align='center' width=672}\n:::\n:::\n\n1. Violin plots are a nice alternative to boxplots because they allow visualizing data distributions directly rather than requiring an intutive grasp of the distribution metrics described by each bit of a boxplot\n2. This is allowing us to 'tilt' the X axis tick labels so they don't overlap with one another\n\nThis plot clearly supports our intuition that among-plot variation is dramatic! We _could_ account for this by including plot as a fixed effect but we'll need to sacrifice a lot of degrees of freedom (think 'statistical power') for a variable that we don't actually care about! Instead, we could include plot as a random effect.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the new model\ntarantula_mem1 <- lmerTest::lmer(tarantula_count ~ road.dist_km + \n                               (1|site.plot), # <1>\n                             data = tarantula_df)\n\n# Extract summary\nsummary(tarantula_mem1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: tarantula_count ~ road.dist_km + (1 | site.plot)\n   Data: tarantula_df\n\nREML criterion at convergence: 4383.4\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.7899 -0.5766 -0.0560  0.5343  3.3630 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n site.plot (Intercept) 3729.1   61.07   \n Residual               763.4   27.63   \nNumber of obs: 450, groups:  site.plot, 30\n\nFixed effects:\n             Estimate Std. Error      df t value Pr(>|t|)   \n(Intercept)    0.6664    32.8628 28.0000   0.020  0.98397   \nroad.dist_km   2.1936     0.7225 28.0000   3.036  0.00513 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr)\nroad.dst_km -0.940\n```\n\n\n:::\n:::\n\n1. Note that we need to use this column as the random effect because <u>plots are not uniquely named across sites</u> (i.e., all sites have plots \"a\", \"b\", and \"c\"). Making the random effect just the 'plot' column would fail to reflect how plots are nested within each site\n\nLooks like there is still a significant effect of road distance on tarantula populations but it is weaker than when we don't account for variation among plots (T values of ~11 versus ~3). However, as we implemented a plot-level random effect we realized there is another source of variation in our data that we know about but for which we don't currently account. In the second year of the study a new graduate student joined our lab and helped us in the field. In the first and third years we worked alone (the new graduate student had their own project to work on in the third year of this work).\n\nThere is an argument for including year as a fixed effect in its own right but some back-of-the-envelope checks reveal no significant difference in climate across the region we worked among those three years. So, while we think that years may differ from one another, that difference is not something we care to analyze but still do want to account for.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the new model\ntarantula_mem2 <- lmerTest::lmer(tarantula_count ~ road.dist_km + \n                               (1|site.plot) + (1|year), \n                             data = tarantula_df)\n\n# Extract summary\nsummary(tarantula_mem2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: tarantula_count ~ road.dist_km + (1 | site.plot) + (1 | year)\n   Data: tarantula_df\n\nREML criterion at convergence: 4079.5\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.8688 -0.5245 -0.0289  0.6262  3.5882 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n site.plot (Intercept) 3755.9   61.29   \n year      (Intercept)  563.7   23.74   \n Residual               360.7   18.99   \nNumber of obs: 450, groups:  site.plot, 30; year, 3\n\nFixed effects:\n             Estimate Std. Error      df t value Pr(>|t|)   \n(Intercept)    0.6664    35.6070 27.0358   0.019  0.98521   \nroad.dist_km   2.1936     0.7225 28.0003   3.036  0.00513 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr)\nroad.dst_km -0.867\n```\n\n\n:::\n:::\n\n\n\n## Multi-Model Inference\n\n\n\n## Meta-Analysis\n\n\n\n## Additional Resources\n\n### Papers & Documents\n\n- [Understanding ‘It Depends’ in Ecology: A Guide to Hypothesising, Visualising and Interpreting Statistical Interactions](https://onlinelibrary.wiley.com/doi/10.1111/brv.12939). Spake _et al._, 2023. **Biological Reviews** \n- [Improving Quantitative Synthesis to Achieve Generality in Ecology](https://www.nature.com/articles/s41559-022-01891-z). Spake _et al._, 2022.**Nature Ecology and Evolution**\n- [Doing Meta-Analysis with R: A Hands-On Guide](https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/). Harrier _et al._ 2023.\n- [Mixed Effects Models and Extensions in Ecology with R](https://link.springer.com/book/10.1007/978-0-387-87458-6). Zuur _et al._, 2009.\n\n### Workshops & Courses\n\n- Matt Vuorre's [Bayesian Meta-Analysis with R, Stan, and brms](https://mvuorre.github.io/posts/2016-09-29-bayesian-meta-analysis/)\n\n### Websites\n\n- \n",
    "supporting": [
      "mod_stats_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}